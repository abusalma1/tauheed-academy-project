<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Class Results - Excellence Academy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-blue-900 text-white sticky top-0 z-50 shadow-lg">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <div class="flex items-center gap-3">
            <img
              src="/placeholder.svg?height=50&width=50"
              alt="School Logo"
              class="h-12 w-12 rounded-full bg-white p-1"
            />
            <div>
              <h1 class="text-xl font-bold">Excellence Academy</h1>
              <p class="text-xs text-blue-200">Nurturing Future Leaders</p>
            </div>
          </div>
          <div class="hidden md:flex items-center gap-6">
            <a href="../index.html" class="hover:text-blue-300 transition"
              >Home</a
            >
            <a href="about.html" class="hover:text-blue-300 transition"
              >About</a
            >
            <a href="admissions.html" class="hover:text-blue-300 transition"
              >Admissions</a
            >
            <a href="fees.html" class="hover:text-blue-300 transition">Fees</a>
            <a href="timetable.html" class="hover:text-blue-300 transition"
              >Timetable</a
            >
            <a href="academics.html" class="hover:text-blue-300 transition"
              >Academics</a
            >
            <a href="staff.html" class="hover:text-blue-300 transition"
              >Staff</a
            >
            <a href="uniform.html" class="hover:text-blue-300 transition"
              >Uniform</a
            >
            <a href="gallery.html" class="hover:text-blue-300 transition"
              >Gallery</a
            >
          </div>
          <button
            id="mobile-menu-btn"
            class="md:hidden text-white focus:outline-none"
          >
            <i class="fas fa-bars text-2xl"></i>
          </button>
        </div>
      </div>
      <div
        id="mobile-menu"
        class="hidden md:hidden bg-blue-800 px-4 py-4 space-y-2"
      >
        <a
          href="../index.html"
          class="block py-2 hover:bg-blue-700 px-3 rounded"
          >Home</a
        >
        <a href="about.html" class="block py-2 hover:bg-blue-700 px-3 rounded"
          >About</a
        >
        <a
          href="admissions.html"
          class="block py-2 hover:bg-blue-700 px-3 rounded"
          >Admissions</a
        >
        <a href="fees.html" class="block py-2 hover:bg-blue-700 px-3 rounded"
          >Fees</a
        >
        <a
          href="timetable.html"
          class="block py-2 hover:bg-blue-700 px-3 rounded"
          >Timetable</a
        >
        <a
          href="academics.html"
          class="block py-2 hover:bg-blue-700 px-3 rounded"
          >Academics</a
        >
        <a href="staff.html" class="block py-2 hover:bg-blue-700 px-3 rounded"
          >Staff</a
        >
        <a href="uniform.html" class="block py-2 hover:bg-blue-700 px-3 rounded"
          >Uniform</a
        >
        <a href="gallery.html" class="block py-2 hover:bg-blue-700 px-3 rounded"
          >Gallery</a
        >
      </div>
    </nav>

    <!-- Page Header -->
    <section class="bg-blue-900 text-white py-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">Class Results</h1>
        <p class="text-xl text-blue-200">
          View Complete Class Performance & Analysis
        </p>
      </div>
    </section>

    <!-- Main Content -->
    <section class="py-16 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Filter Section -->
        <div
          class="bg-white rounded-lg shadow-lg p-8 border-2 border-blue-900 mb-8"
        >
          <h2 class="text-2xl font-bold text-gray-900 mb-6">
            <i class="fas fa-filter text-blue-900 mr-3"></i>Filter Class Results
          </h2>

          <div class="grid md:grid-cols-4 gap-4">
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                <i class="fas fa-graduation-cap mr-2 text-blue-900"></i>Select
                Class
              </label>
              <select
                id="classSelect"
                class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-900"
              >
                <option value="">Choose a class</option>
                <option value="Primary 1">Primary 1</option>
                <option value="Primary 2">Primary 2</option>
                <option value="Primary 3">Primary 3</option>
                <option value="Primary 4">Primary 4</option>
                <option value="Primary 5">Primary 5</option>
                <option value="Primary 6">Primary 6</option>
                <option value="JSS 1">JSS 1</option>
                <option value="JSS 2">JSS 2</option>
                <option value="JSS 3">JSS 3</option>
                <option value="SSS 1">SSS 1</option>
                <option value="SSS 2">SSS 2</option>
                <option value="SSS 3">SSS 3</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                <i class="fas fa-book mr-2 text-blue-900"></i>Select Subject
              </label>
              <select
                id="subjectSelect"
                class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-900"
              >
                <option value="">All Subjects</option>
                <option value="Mathematics">Mathematics</option>
                <option value="English Language">English Language</option>
                <option value="Science">Science</option>
                <option value="Social Studies">Social Studies</option>
                <option value="Computer Science">Computer Science</option>
                <option value="Physical Education">Physical Education</option>
                <option value="Arts">Arts</option>
                <option value="Music">Music</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                <i class="fas fa-calendar mr-2 text-blue-900"></i>Select Term
              </label>
              <select
                id="termSelect"
                class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-900"
              >
                <option value="">All Terms</option>
                <option value="First Term">First Term</option>
                <option value="Second Term">Second Term</option>
                <option value="Third Term">Third Term</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                <i class="fas fa-search mr-2 text-blue-900"></i>Action
              </label>
              <button
                onclick="loadClassResults()"
                class="w-full bg-blue-900 text-white py-2 rounded-lg font-semibold hover:bg-blue-800 transition"
              >
                Load Results
              </button>
            </div>
          </div>
        </div>

        <!-- Class Statistics -->
        <div id="statsContainer" class="hidden grid md:grid-cols-5 gap-4 mb-8">
          <div class="bg-blue-50 p-6 rounded-lg border-2 border-blue-200">
            <p class="text-sm text-gray-600">Total Students</p>
            <p class="text-3xl font-bold text-blue-900" id="totalStudents">0</p>
          </div>
          <div class="bg-green-50 p-6 rounded-lg border-2 border-green-200">
            <p class="text-sm text-gray-600">Class Average</p>
            <p class="text-3xl font-bold text-green-900" id="classAverage">
              0%
            </p>
          </div>
          <div class="bg-yellow-50 p-6 rounded-lg border-2 border-yellow-200">
            <p class="text-sm text-gray-600">Highest Score</p>
            <p class="text-3xl font-bold text-yellow-900" id="highestScore">
              0
            </p>
          </div>
          <div class="bg-orange-50 p-6 rounded-lg border-2 border-orange-200">
            <p class="text-sm text-gray-600">Lowest Score</p>
            <p class="text-3xl font-bold text-orange-900" id="lowestScore">0</p>
          </div>
          <div class="bg-purple-50 p-6 rounded-lg border-2 border-purple-200">
            <p class="text-sm text-gray-600">Pass Rate</p>
            <p class="text-3xl font-bold text-purple-900" id="passRate">0%</p>
          </div>
        </div>

        <!-- Results Table -->
        <div id="resultsContainer" class="text-center text-gray-500 py-12">
          <i class="fas fa-search text-4xl mb-4 opacity-50"></i>
          <p>
            Select a class and click "Load Results" to view class performance
          </p>
        </div>

        <!-- Print Button -->
        <div id="printButtonContainer" class="hidden mt-8 text-center">
          <button
            onclick="printClassResults()"
            class="bg-green-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-700 transition inline-flex items-center gap-2"
          >
            <i class="fas fa-print"></i>Print Class Results
          </button>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-xl font-bold mb-4">Excellence Academy</h3>
            <p class="text-gray-400 text-sm leading-relaxed">
              Committed to providing quality education and nurturing future
              leaders through academic excellence and character development.
            </p>
          </div>
          <div>
            <h3 class="text-xl font-bold mb-4">Quick Links</h3>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="../index.html"
                  class="text-gray-400 hover:text-white transition"
                  >Home</a
                >
              </li>
              <li>
                <a
                  href="about.html"
                  class="text-gray-400 hover:text-white transition"
                  >About Us</a
                >
              </li>
              <li>
                <a
                  href="admissions.html"
                  class="text-gray-400 hover:text-white transition"
                  >Admissions</a
                >
              </li>
              <li>
                <a
                  href="academics.html"
                  class="text-gray-400 hover:text-white transition"
                  >Academics</a
                >
              </li>
              <li>
                <a
                  href="gallery.html"
                  class="text-gray-400 hover:text-white transition"
                  >Gallery</a
                >
              </li>
            </ul>
          </div>
          <div>
            <h3 class="text-xl font-bold mb-4">Contact Us</h3>
            <ul class="space-y-2 text-sm text-gray-400">
              <li>
                <i class="fas fa-map-marker-alt mr-2"></i>123 Education Street,
                City
              </li>
              <li><i class="fas fa-phone mr-2"></i>+234 800 123 4567</li>
              <li>
                <i class="fas fa-envelope mr-2"></i>info@excellenceacademy.edu
              </li>
              <li><i class="fab fa-whatsapp mr-2"></i>+234 800 123 4567</li>
            </ul>
          </div>
          <div>
            <h3 class="text-xl font-bold mb-4">Follow Us</h3>
            <div class="flex gap-4">
              <a
                href="#"
                class="bg-blue-600 hover:bg-blue-700 w-10 h-10 rounded-full flex items-center justify-center transition"
              >
                <i class="fab fa-facebook-f"></i>
              </a>
              <a
                href="#"
                class="bg-blue-400 hover:bg-blue-500 w-10 h-10 rounded-full flex items-center justify-center transition"
              >
                <i class="fab fa-twitter"></i>
              </a>
              <a
                href="#"
                class="bg-pink-600 hover:bg-pink-700 w-10 h-10 rounded-full flex items-center justify-center transition"
              >
                <i class="fab fa-instagram"></i>
              </a>
            </div>
          </div>
        </div>
        <div
          class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400 text-sm"
        >
          <p>&copy; 2025 Excellence Academy. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script>
      const mobileMenuBtn = document.getElementById("mobile-menu-btn");
      const mobileMenu = document.getElementById("mobile-menu");
      mobileMenuBtn.addEventListener("click", () => {
        mobileMenu.classList.toggle("hidden");
      });

      function getGrade(score) {
        if (score >= 80) return "A";
        if (score >= 70) return "B";
        if (score >= 60) return "C";
        if (score >= 50) return "D";
        return "F";
      }

      function getGradeColor(grade) {
        switch (grade) {
          case "A":
            return "bg-green-600 text-white";
          case "B":
            return "bg-blue-600 text-white";
          case "C":
            return "bg-yellow-600 text-white";
          case "D":
            return "bg-orange-600 text-white";
          case "F":
            return "bg-red-600 text-white";
          default:
            return "bg-gray-600 text-white";
        }
      }

      function loadClassResults() {
        const selectedClass = document.getElementById("classSelect").value;
        const selectedSubject = document.getElementById("subjectSelect").value;
        const selectedTerm = document.getElementById("termSelect").value;

        if (!selectedClass) {
          alert("Please select a class");
          return;
        }

        const allResults =
          JSON.parse(localStorage.getItem("schoolResults")) || [];

        const filtered = allResults.filter((result) => {
          const matchClass = result.class === selectedClass;
          const matchSubject =
            !selectedSubject || result.subject === selectedSubject;
          const matchTerm = !selectedTerm || result.term === selectedTerm;
          return matchClass && matchSubject && matchTerm;
        });

        if (filtered.length === 0) {
          document.getElementById("resultsContainer").innerHTML = `
                    <div class="text-center text-gray-500 py-12">
                        <i class="fas fa-inbox text-4xl mb-4 opacity-50"></i>
                        <p>No results found for the selected criteria</p>
                    </div>
                `;
          document.getElementById("statsContainer").classList.add("hidden");
          document
            .getElementById("printButtonContainer")
            .classList.add("hidden");
          return;
        }

        // Group by student
        const groupedByStudent = {};
        filtered.forEach((result) => {
          if (!groupedByStudent[result.student]) {
            groupedByStudent[result.student] = [];
          }
          groupedByStudent[result.student].push(result);
        });

        // Calculate statistics
        const allScores = filtered.map((r) => r.total);
        const classAverage = Math.round(
          allScores.reduce((a, b) => a + b, 0) / allScores.length
        );
        const highestScore = Math.max(...allScores);
        const lowestScore = Math.min(...allScores);
        const passCount = allScores.filter((s) => s >= 50).length;
        const passRate = Math.round((passCount / allScores.length) * 100);

        // Update statistics
        document.getElementById("totalStudents").textContent =
          Object.keys(groupedByStudent).length;
        document.getElementById("classAverage").textContent =
          classAverage + "%";
        document.getElementById("highestScore").textContent = highestScore;
        document.getElementById("lowestScore").textContent = lowestScore;
        document.getElementById("passRate").textContent = passRate + "%";
        document.getElementById("statsContainer").classList.remove("hidden");

        // Build results table
        let html = `
                <div class="bg-white rounded-lg shadow-lg border-2 border-gray-200 overflow-hidden">
                    <div class="bg-blue-900 text-white p-6">
                        <h3 class="text-2xl font-bold">${selectedClass} - Class Results</h3>
                        <p class="text-blue-200">${
                          selectedSubject ? selectedSubject : "All Subjects"
                        } ${selectedTerm ? "- " + selectedTerm : ""}</p>
                    </div>

                    <div class="p-6 overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="px-4 py-3 text-left">Student Name</th>
                                    <th class="px-4 py-3 text-center">Subject</th>
                                    <th class="px-4 py-3 text-center">CA</th>
                                    <th class="px-4 py-3 text-center">Exam</th>
                                    <th class="px-4 py-3 text-center">Total</th>
                                    <th class="px-4 py-3 text-center">Grade</th>
                                    <th class="px-4 py-3 text-center">Status</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
            `;

        Object.entries(groupedByStudent).forEach(([student, results]) => {
          results.forEach((result, index) => {
            const status =
              result.total >= 50
                ? '<span class="text-green-600 font-bold">Pass</span>'
                : '<span class="text-red-600 font-bold">Fail</span>';
            html += `
                        <tr class="hover:bg-gray-50">
                            ${
                              index === 0
                                ? `<td class="px-4 py-3 font-bold" rowspan="${results.length}">${student}</td>`
                                : ""
                            }
                            <td class="px-4 py-3">${result.subject}</td>
                            <td class="px-4 py-3 text-center">${result.ca}</td>
                            <td class="px-4 py-3 text-center">${
                              result.exam
                            }</td>
                            <td class="px-4 py-3 text-center font-bold">${
                              result.total
                            }</td>
                            <td class="px-4 py-3 text-center">
                                <span class="px-3 py-1 rounded-full text-white font-bold ${getGradeColor(
                                  result.grade
                                )}">${result.grade}</span>
                            </td>
                            <td class="px-4 py-3 text-center">${status}</td>
                        </tr>
                    `;
          });
        });

        html += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

        document.getElementById("resultsContainer").innerHTML = html;
        document
          .getElementById("printButtonContainer")
          .classList.remove("hidden");
      }

      function printClassResults() {
        const container = document.getElementById("resultsContainer");
        const statsContainer = document.getElementById("statsContainer");

        if (container.innerHTML.includes("No results found")) {
          alert("Please load results first");
          return;
        }

        const printWindow = window.open("", "", "height=600,width=900");
        printWindow.document.write(
          "<html><head><title>Class Results Report</title>"
        );
        printWindow.document.write("<style>");
        printWindow.document.write(
          "body { font-family: Arial, sans-serif; margin: 20px; }"
        );
        printWindow.document.write(
          "table { width: 100%; border-collapse: collapse; margin: 20px 0; }"
        );
        printWindow.document.write(
          "th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }"
        );
        printWindow.document.write(
          "th { background-color: #003d82; color: white; }"
        );
        printWindow.document.write("h3 { color: #003d82; }");
        printWindow.document.write(
          ".header { background-color: #003d82; color: white; padding: 20px; margin-bottom: 20px; }"
        );
        printWindow.document.write(
          ".stats { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0; }"
        );
        printWindow.document.write(
          ".stat-box { border: 1px solid #ddd; padding: 15px; text-align: center; }"
        );
        printWindow.document.write("</style></head><body>");
        printWindow.document.write(
          '<div class="header"><h2>Excellence Academy - Class Results Report</h2></div>'
        );
        printWindow.document.write(
          '<div class="stats">' + statsContainer.innerHTML + "</div>"
        );
        printWindow.document.write(container.innerHTML);
        printWindow.document.write("</body></html>");
        printWindow.document.close();
        printWindow.print();
      }
    </script>
  </body>
</html>
